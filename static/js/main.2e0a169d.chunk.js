(window["webpackJsonpdrum-machine"]=window["webpackJsonpdrum-machine"]||[]).push([[0],[,,,,,,,,,,,,,function(e){e.exports=JSON.parse('{"githubLink":"https://www.github.com/Yona168/drum-machine","apiLink":"https://yona168-drum-machine-sounds.glitch.me"}')},,,,,,function(e,t,n){e.exports=n(37)},,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),o=n(10),s=n(0),c=n.n(s),i=n(16),u=n.n(i),l=(n(25),n(11)),p=n(4),d=n(5),h=n(8),g=n(7),m=n(9),f=new Map,k=[{background:"#F7D87C",machine:"#28CCFA",border:"5px solid black",measureBorder:"2px solid gray",button:"white",text:"black",name:"default"},{background:"gray",machine:"gray",border:"5px solid black",measureBorder:"2px solid black",button:"black",text:"white",name:"dark"},{background:"black",machine:"white",border:"5px solid black",measureBorder:"2px solid black",button:"black",text:"white",name:"ghost"},{background:"red",machine:"yellow",border:"5px solid black",measureBorder:"2px solid black",button:"orange",text:"yellow",name:"hot dog"}];k.forEach(function(e){return f.set(e.name,e)});var v=function(e){var t=f.get(e);if(!t)throw new Error("No theme of name ".concat(e,"!"));return t},y=function(){return f.keys()},b=c.a.createContext(k[0]),x={THEMES:k,addTheme:function(e,t){return f.set(e,t)},getTheme:v,getThemeNames:y,Context:b},w=(n(26),n(27),n(28),function(e){var t=e.selected&&e.onNote;return t&&e.howlProvider().play(),c.a.createElement("div",{className:"track-light",style:{backgroundColor:t?"red":e.selected?"white":"transparent",gridColumnStart:e.indexInMeasure+1,gridColumnEnd:e.indexInMeasure+2},onClick:function(){return e.setSelected(!e.selected)}})}),E=function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"getTrackLights",value:function(){for(var e=this,t=[],n=function(n){t.push(c.a.createElement(w,{indexInMeasure:n,key:n,onNote:e.props.noteIndex===n,howlProvider:e.props.howlProvider,selected:e.props.beats[n],setSelected:function(t){var a=e.props.beats.slice();a[n]=t,e.props.setBeats(a)}}))},a=0;a<this.props.beats.length;a++)n(a);return t}},{key:"render",value:function(){return c.a.createElement("div",{className:"measure",style:{gridColumnStart:this.props.measureIndex+2,gridColumnEnd:this.props.measureIndex+3,gridRowStart:1,gridRowEnd:2,gridTemplateColumns:"repeat(".concat(this.props.beats.length,", auto)"),border:this.context.measureBorder}},this.getTrackLights())}}]),t}(c.a.Component);E.contextType=x.Context;var C=n(6),S=n(3),P=(n(34),function(e){var t=c.a.useState(e.default),n=Object(l.a)(t,2),a=n[0],r=n[1],o=[],s=[],i=!0,u=!1,p=void 0;try{for(var d,h=e.soundCache.getSoundsFromCategory(a.category)[Symbol.iterator]();!(i=(d=h.next()).done);i=!0){var g=d.value;s.push(c.a.createElement("option",{value:g,key:g},g))}}catch(v){u=!0,p=v}finally{try{i||null==h.return||h.return()}finally{if(u)throw p}}for(var m=e.soundCache.categories,f=m.next();!f.done;){var k=f.value;o.push(c.a.createElement("option",{value:k,key:k},k)),f=m.next()}return c.a.createElement("form",{className:"change-form"},c.a.createElement("select",{name:"category",value:a.category,onChange:function(t){var n=t.target.value;if(n!==a.category){var o=e.soundCache.getSoundsFromCategory(n)[0];r({category:n,sound:o})}}},o),c.a.createElement("select",{name:"sound",value:a.sound,onChange:function(e){r({category:a.category,sound:e.target.value})}},s),c.a.createElement("div",{className:"check-container",onClick:function(){e.changeTrackTo(a),e.closeChangeBox()}},c.a.createElement(C.a,{className:"check",icon:S.c})))}),M=function(e){var t=c.a.useState(!1),n=Object(l.a)(t,2),a=n[0],r=n[1],o=c.a.useContext(x.Context);return a?c.a.createElement(P,{soundCache:e.soundCache,default:e.sound,changeTrackTo:function(t){e.changeTrack(t)},closeChangeBox:function(){return r(!1)}}):c.a.createElement("div",{className:"track-controller",style:{gridColumnStart:1,gridColumnEnd:2,gridRowStart:0,gridRowEnd:2,border:o.measureBorder}},c.a.createElement("p",{className:"track-name"},e.sound.sound),c.a.createElement("div",{className:"remove-button button",onClick:function(){return e.removeTrack()},style:{backgroundColor:o.button}},c.a.createElement(C.a,{className:"icon",icon:S.h})),c.a.createElement("div",{className:"change-button button",onClick:function(){return r(!0)},style:{backgroundColor:o.button}},c.a.createElement(C.a,{className:"icon",icon:S.d})))},T=(n(35),function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(h.a)(this,Object(g.a)(t).call(this,e))).state={howl:function(){return null}},n.updateSound(),n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"howlFrom",value:function(){var e=Object(o.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.soundCache.getSound(t);case 2:if(n=e.sent){e.next=7;break}throw new Error("Invalid sound!");case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"updateSound",value:function(){var e=this;this.howlFrom(this.props.trackInfo.sound).then(function(t){return e.setState({howl:t})})}},{key:"componentDidMount",value:function(){this.updateSound()}},{key:"componentDidUpdate",value:function(e){e.trackInfo.sound!==this.props.trackInfo.sound&&this.updateSound()}},{key:"getMeasures",value:function(){var e=this,t=[];if(!this.state.howl())return t;for(var n=function(n){var a;t.push(c.a.createElement(E,{key:n,measureIndex:n,howlProvider:function(){return e.state.howl()},noteIndex:(a=n,-1===e.props.currentPlayingIndex?-1:a===Math.floor(e.props.currentPlayingIndex/e.props.beatsPerMeasure)?e.props.currentPlayingIndex%e.props.beatsPerMeasure:-1),beats:e.props.trackInfo.selected[n],setBeats:function(t){var a=e.props.trackInfo.selected.slice();a[n]=t,e.props.setBeats(a)}}))},a=0;a<this.props.amtMeasures;a++)n(a);return t}},{key:"render",value:function(){return c.a.createElement("div",{className:"track",style:{gridRowStart:this.props.trackIndex,gridRowEnd:this.props.trackIndex+1,gridColumnStart:1,gridColumnEnd:this.props.amtMeasures,border:this.context.trackBorder}},c.a.createElement(M,{soundCache:this.props.soundCache,sound:this.props.trackInfo.sound,changeTrack:this.props.changeTrack,removeTrack:this.props.removeTrack}),this.state.howl()?this.getMeasures():c.a.createElement("p",null,"Loading..."))}}]),t}(c.a.Component));T.contextType=x.Context;var I=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(h.a)(this,Object(g.a)(t).call(this,e))).state={currentPlayingIndex:-1},window.addEventListener("keydown",function(e){80===e.keyCode&&n.props.setPlaying(!n.props.playing)}),n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"getMeasuresPerTrack",value:function(){return this.props.tracks[0].selected.length}},{key:"getBeatsPerMeasure",value:function(){return this.props.tracks[0].selected[0].length}},{key:"componentDidUpdate",value:function(e){e.playing!==this.props.playing?this.togglePlaying(this.props.playing,!0):e.beatsPerMinute!==this.props.beatsPerMinute&&this.props.playing&&(this.togglePlaying(!1,!0),this.togglePlaying(!0,!1)),this.props.tracks.length!==e.tracks.length&&this.props.updateAppWidth()}},{key:"componentDidMount",value:function(){this.props.updateAppWidth()}},{key:"togglePlaying",value:function(e,t){var n=this;if(e)var a=window.setInterval(function(){n.setState({currentPlayingIndex:n.state.currentPlayingIndex===n.getMeasuresPerTrack()*n.getBeatsPerMeasure()-1?0:n.state.currentPlayingIndex+1,task:a})},6e4/this.props.beatsPerMinute);else{var r=this.state.task;r&&(window.clearTimeout(r),this.setState({currentPlayingIndex:t?-1:this.state.currentPlayingIndex,task:void 0}))}}},{key:"getTracks",value:function(){var e=this;return this.props.tracks.map(function(t,n){return c.a.createElement(T,{soundCache:e.props.soundCache,isCurrentlyPlaying:e.props.playing,amtMeasures:e.getMeasuresPerTrack(),beatsPerMeasure:e.getBeatsPerMeasure(),trackIndex:n,trackInfo:t,key:n,setBeats:function(t){var a=e.props.tracks.slice();a[n].selected=t,e.props.setTracks(a)},removeTrack:function(){if(1!==e.props.tracks.length){var t=e.props.tracks.slice();t.splice(n,1),e.props.setTracks(t)}},changeTrack:function(t){var a=e.props.tracks.slice();a.splice(n,1,{sound:t,selected:e.props.tracks[n].selected}),e.props.setTracks(a)},currentPlayingIndex:e.state.currentPlayingIndex})})}},{key:"render",value:function(){var e=this,t=this.context;return c.a.createElement("div",{id:"frame",style:{backgroundColor:t.machine,border:t.border}},this.getTracks(),c.a.createElement("div",{className:"add-icon-container",style:{gridRowStart:this.props.tracks.length,gridRowEnd:this.props.tracks.length+1,gridColumnStart:1,gridColumnEnd:this.getMeasuresPerTrack()},onClick:function(){for(var t=e.props.tracks.slice(),n=[],a=0;a<e.getMeasuresPerTrack();a++){n[a]=[];for(var r=0;r<e.getBeatsPerMeasure();r++)n[a][r]=!1}t.push({sound:{category:"Acoustic",sound:"Tom-04"},selected:n}),e.props.setTracks(t)}},c.a.createElement(C.a,{className:"add-icon",icon:S.f})))}}]),t}(c.a.Component);I.contextType=x.Context;var O=n(17),j=(n(36),function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(h.a)(this,Object(g.a)(t).call(this,e))).state={playing:!1,appHeight:0,beatsPerMinute:90,tracks:n.getInitialSounds(),theme:k[0]},n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"getInitialSounds",value:function(){function e(e,t){for(var n=[],a=0;a<4;a++){n[a]=[];for(var r=0;r<4;r++)n[a][r]=!1}return{sound:{category:e,sound:t},selected:n}}return[e("Acoustic","ClHat-01"),e("Acoustic","Crash-02"),e("Acoustic","Tom-04")]}},{key:"setBeatsPerMeasure",value:function(e){var t=this.state.tracks.slice();t.forEach(function(t){return t.selected.forEach(function(t){return t.length=e})}),this.setState({tracks:t})}},{key:"setAmountMeasures",value:function(e){var t=this,n=this.state.tracks.slice();n.forEach(function(n){var a=n.selected.length;if(n.selected.length=e,e>a)for(var r=a;r<n.selected.length;r++){n.selected[r]=[],n.selected[r].length=t.state.tracks[0].selected[0].length;for(var o=0;o<n.selected[r].length;o++)n.selected[r][o]=!1}}),this.setState({tracks:n})}},{key:"render",value:function(){var e=this;return c.a.createElement("div",{className:"DrumMachineApp",style:{height:"".concat(this.state.appHeight,"px")}},c.a.createElement(b.Provider,{value:this.state.theme},c.a.createElement(N,{playing:this.state.playing,bpm:this.state.beatsPerMinute,tracks:this.state.tracks,useApp:function(t){return t(e)}}),c.a.createElement(B,null,c.a.createElement(I,{soundCache:this.props.soundCache,playing:this.state.playing,beatsPerMinute:this.state.beatsPerMinute,setPlaying:function(t){e.setState({playing:t})},setTracks:function(t){return e.setState({tracks:t})},tracks:this.state.tracks,updateAppWidth:function(){var t=Math.max(document.body.scrollHeight,window.outerHeight),n=Math.max(t,e.state.appHeight);e.state.appHeight!==n&&e.setState({appHeight:n})}}),c.a.createElement(A,null))))}}]),t}(c.a.Component)),N=function(e){var t=c.a.useState(!1),n=Object(l.a)(t,2),a=n[0],r=n[1],o=c.a.useContext(b),s=function(){return c.a.createElement("div",{className:"show-button",onClick:function(){return r(!a)}},c.a.createElement(C.a,{icon:a?S.a:S.b,style:{color:o.text,fontSize:"200%"}}))},i=function(t,n,a,r,s){return c.a.createElement("div",{className:"".concat(t,"-control control")},c.a.createElement("p",{className:"input-title",style:{color:o.text}},t.toUpperCase()),c.a.createElement("input",{className:"input-box",type:"number",name:t.toUpperCase(),min:n,max:a,defaultValue:r.toString(),style:{width:"100%"},onKeyUp:function(t){if(13===t.keyCode){var r=parseInt(t.currentTarget.value);return r<n?(t.currentTarget.value=n.toString(),r=n):r>a&&(t.currentTarget.value=a.toString(),r=a),e.useApp(function(e){return s(e,r)}),!1}}}))};return a?c.a.createElement("div",{className:"play-controller controller"},c.a.createElement("div",{className:"play-button",onClick:function(){return e.useApp(function(t){return t.setState({playing:!e.playing})})}},c.a.createElement(C.a,{className:"toggle-icon",icon:e.playing?S.g:S.e})),s(),i("bpm",10,500,e.bpm,function(e,t){return e.setState({beatsPerMinute:t})}),i("beats",1,8,e.tracks[0].selected[0].length,function(e,t){return e.setBeatsPerMeasure(t)}),i("measures",1,16,e.tracks[0].selected.length,function(e,t){return e.setAmountMeasures(t)}),function(){for(var t=y(),n=t.next(),a=[];!n.done;)a.push(c.a.createElement("option",{value:n.value,key:n.value},n.value)),n=t.next();return c.a.createElement("div",{className:"theme-control control"},c.a.createElement("p",{className:"input-title",style:{color:o.text}},"THEME"),c.a.createElement("select",{name:"theme",className:"input-box",value:o.name,onChange:function(t){var n=v(t.target.value);n&&e.useApp(function(e){return e.setState({theme:n})})}},a))}(),c.a.createElement("p",{id:"instructions",style:{color:o.text}},"Press Enter in a box to update changes!")):c.a.createElement("div",{className:"hidden-play-controller controller"},s())},B=function(e){var t=c.a.useContext(b);return c.a.createElement("div",{id:"root-grid",style:{background:t.background}},e.children)},A=function(){var e=n(13).githubLink;return c.a.createElement("div",{id:"right"},c.a.createElement("div",{onClick:function(){window.open(e,"_blank")}},c.a.createElement(C.a,{className:"github-icon",icon:O.a})))},H=n(18),L=function(){function e(t){var a=this;Object(p.a)(this,e),this.allSounds=void 0,this.cache=new Map,this.apiLink=n(13).apiLink,this.allSounds=t,t.forEach(function(e,t){a.cache.set(t,new Map)})}return Object(d.a)(e,[{key:"pull",value:function(e,t){var n=this;return new Promise(function(a,r){var o=new H.Howl({src:["".concat(n.apiLink,"/sound/").concat(e,"/").concat(t,".wav")]});o.once("load",function(){return a(o)}),o.once("loaderror",function(e){return r("Error loading howl! "+e)})})}},{key:"get",value:function(){var e=Object(o.a)(r.a.mark(function e(t,n){var a,o,s,c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.allSounds.get(t)){e.next=3;break}return e.abrupt("return",void 0);case 3:if(-1!==a.indexOf(n)){e.next=5;break}return e.abrupt("return",void 0);case 5:if(o=new Map,(s=this.cache.get(t))&&(o=s),e.t0=o.get(n),e.t0){e.next=13;break}return e.next=12,this.pull(t,n);case 12:e.t0=e.sent;case 13:return c=e.t0,o.set(n,c),e.abrupt("return",function(){return c});case 16:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getSound",value:function(){var e=Object(o.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get(t.category,t.sound);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getSoundsFromCategory",value:function(e){return this.allSounds.get(e)}},{key:"categories",get:function(){return this.allSounds.keys()}},{key:"sounds",get:function(){return this.allSounds.values()}}],[{key:"create",value:function(){var t=Object(o.a)(r.a.mark(function t(){var a,o;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=new Map,t.next=3,fetch("".concat(n(13).apiLink,"/paths")).then(function(e){return e.json()});case 3:return o=t.sent,Object.keys(o).forEach(function(e){o[e].forEach(function(t){var n=a.get(e)?a.get(e):[];n.push(t),a.set(e,n)})}),t.abrupt("return",new e(a));case 6:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()}]),e}();Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function R(){return(R=Object(o.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=u.a,e.t1=c.a,e.t2=j,e.next=5,L.create();case 5:e.t3=e.sent,e.t4={soundCache:e.t3},e.t5=e.t1.createElement.call(e.t1,e.t2,e.t4),e.t6=document.getElementById("root"),e.t0.render.call(e.t0,e.t5,e.t6);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}!function(){R.apply(this,arguments)}(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}],[[19,1,2]]]);
//# sourceMappingURL=main.2e0a169d.chunk.js.map